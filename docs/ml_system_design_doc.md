# ML System Design Doc - [RU]
## Дизайн ML системы - Система анализа эксплуатации оборудования с выявлением отклонений    

> ## Термины и пояснения  
> - Итерация - это все работы, которые совершаются до старта очередного пилота  
> - БТ - бизнес-требования 
> - EDA - Exploratory Data Analysis - исследовательский анализ данных  
> - `Data Scientist` - `Data Scientist` совмещает в себе компетенции классического `Data Scientist` с упором на исследования и `ML Engineer` & `ML Ops` роли с акцентом на продуктивизацию моделей.  
> - `Product Owner` - зказчик  
> - ТО - техническое обслуживание оборудования  
> - Предиктивное ТО - Предиктивное техническое обслуживание - комплексный подход, позволяющий определить состояние находящегося в эксплуатации оборудования и оценить, когда следует провести техническое обслуживание.  
> - ML -  Машинное обучение
> - ВР - временной ряд, в контексте данной задачи сигнал снятый с сенсора.

### 1. Цели и предпосылки 
#### 1.1. Зачем идем в разработку продукта?  

- Бизнес-цель: заключается в автоматизации процесса диагностики состояния машин и оборудования производителя круп «Увелка» в онлайн-режиме с целью выявления отклонений от номинальных режимов работы и своевременного уведомления о необходимости проведения технического обслуживания оборудования.  
- Почему станет лучше, чем сейчас, от использования ML: может помочь в более точном прогнозировании состояния оборудования, выявлении скрытых закономерностей в данных, автоматизации анализа больших объемов информации, а также в улучшении точности и скорости диагностики, что в свою очередь может снизить количество непредвиденных поломок и оптимизировать график обслуживания.  
- Что будем считать успехом итерации с точки зрения бизнеса: получение MVP системы по аналитике состояния оборудования и уведомлению об отклонениях и необходимости проведения технического обслуживания.
    - Модель должна достаточно хорошо обнаруживать аномалии - Recall > 80% (пропуск неполадок), не менее важно, чтобы нормальное показатели не были отнесены к аномальным - Precision > 80% (лишнее срабатывание), как среднее гармоническое f1 между первыми двумя планируется использовать с показателем > 80%.
    - Сервис будет извещать работника предприятия о аномальном сигнале, например в телеграмме или через домен приложения.

#### 1.2. Бизнес-требования и ограничения  

- Краткое описание БТ и ссылки на детальные документы с бизнес-требованиями:  
  1. Модель должна, на основе собранных данных с сенсоров оборудования за длительность текущей смены (конкретная, достаточная для вывода о сигнале, длительность будет вычисляться), оповещать о необходимости проведения технического обслуживания.  
  2. Наличие самостоятельного хостинга или развертывание проекта на локальной машине.  
- Бизнес-ограничения: на данной итерации конкретные ограничения от `Product Owner` ещё не сформированы.  
- Что мы ожидаем от конкретной итерации: решение задачи детекции аномального сигнала Recall > 80%, Precision > 80%, f1 > 80%.  
- Описание бизнес-процесса пилота: сервис будет оповещать инженеров, через телеграм оповещение и через меню на домене сервиса (web приложение), о аномальном сигнале и о необходимости проведения технического обслуживания для конкретной единицы оборудования.  
- Что считаем успешным пилотом? Критерии успеха и возможные пути развития проекта: предиктивное ТО успешно справляется с детекцией аномального поведения сигнала (Recall > 80%, Precision > 80%, f1 > 80%) и с составлением графика проведения технических работ.

#### 1.3. Что входит в скоуп проекта/итерации, что не входит   

- На закрытие каких БТ подписываемся в данной итерации: сервис (web приложение), которое по снятому сигналу с датчиков (достаточная длительность для вывода о аномальности сигнала будет определена для каждого устройства в будущем) обнаруживает неисправность оборудования и оповещает работников предприятия.
- Что не будет закрыто: пока нет описания состояния оборудования для конкретного временного периода (причины остановки оборудования, зафиксированные неисправности), поэтому нет возможности сделать предективное ТО.
- Описание результата с точки зрения качества кода и воспроизводимости решения: микросервисная архитектура с возможностью развертывания через Doker, а также сами модели детекции в виде .py скриптов.  
- Описание планируемого технического долга (что оставляем для дальнейшей продуктивизации): модель, которая на основе собранных за определенный период данных делает прогноз о дате проведения ТО.

#### 1.4. Предпосылки решения  

- Описание всех общих предпосылок решения, используемых в системе – с обоснованием от запроса бизнеса: какие блоки данных используем, горизонт прогноза, гранулярность модели, и др. `Data Scientist`:  
 1. Блоки данных  
    - Данные о состоянии оборудования  
       - Датчики и показания: Данные, собранные с помощью сенсоров (температура, давление, вибрация и т.д.), играют ключевую роль в оценке технического состояния оборудования.  
       - История неполадок: Записи о предыдущих авариях, ремонтах и осмотрах, которые могут помочь в выявлении паттернов и трендов.  
    - Оперативные данные  
       - Рабочие условия: Информация о нагрузке на оборудование, циклах работы и прерываниях будет способствовать более точному прогнозированию состояний.    
2. Горизонт прогноза (пока что не определен, так как пока нет данных необходимых для определения временных периодов)  
    - Краткосрочный прогноз (1 час; пока что примерно): Используется для оперативного обнаружения неисправностей в оборудовании.
    - Среднесрочный прогноз (внутри 1 месяца): Используется для прогнозирования ТО. Сейчас плановые ТО каждый месяц.
3. Гранулярность модели
    - Уровень агрегирования: Данные могут агрегироваться на уровне отдельного оборудования или группы оборудования, какой вариант лучше будет выясняться дальше через тестирование и консультацию с инженерами.
    - Частота обновления данных: Модель может использовать данные в реальном времени или обновляться на основе заданного графика (например, ежедневно, еженедельно).
4. Обоснование от запроса бизнеса
    - Уменьшение простоев: Бизнес-потребность в минимизации времени простоя оборудования требует точных прогнозов о его состоянии и возможных сбоях.
    - Оптимизация затрат: Понимание, когда и какое оборудование потребует обслуживания, помогает минимизировать неплановые ремонты и оптимизировать запасы запчастей.
    - Повышение надежности: Системы предиктивного ТО должны быть интегрированы в общую стратегию повышения надежности и долговечности оборудования.
    - Устойчивость к изменениям: Способность адаптироваться к изменениям в производственных условиях или в самом оборудовании требует гибкой модели, способной учитывать новые данные.

### 2. Методология `Data Scientist`     

#### 2.1. Постановка задачи  

- Что делаем с технической точки зрения: определяем статична ли амплитуда периодического сигнала за текущее время работы (от начала смены до времени проверки, вплоть до конца - 12 часов) для любой конфигурации оборудования (конфигурация очень часто меняется и для каждой конфигурации величина амплитуды будет своя) (Change point detection).
- Со временем оборудование изнашивается и для одной и той же конфигурации оборудования амплитуда будет постепенно увеличиваться (в пределах одной смены амплитуда статична, но в бОльших пределах маленький тренд будет заметен) - это нужно отслеживать и при достижении некоторого порога (будет вычисляться экспериментально) извещать работника предприятия (remaining useful life prediction).

#### 2.2. Блок-схема решения    
- [Блок схема](https://github.com/Anzovi/Fault-Detection/blob/homework_1/docs/Uvelka_Plan.png) 
